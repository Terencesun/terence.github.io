{"title":"【转载】Go 项目实战：实现一个 Redis(5) 之使用跳表实现 SortedSet","date":"2021-03-13T16:19:49.000Z","date_formatted":{"ll":"Mar 14, 2021","L":"03/14/2021","MM-DD":"03-14"},"link":"2021/03/14/2021-03-13-06","comments":true,"tags":["golang实现redis"],"updated":"2022-10-17T01:08:12.567Z","content":"<blockquote>\n<p>本文由 <a href=\"http://ksria.com/simpread/\" target=\"_blank\">简悦 SimpRead</a> 转码， 原文地址 <a href=\"https://mp.weixin.qq.com/s?src=11%C3%97tamp=1615647086&amp;ver=2944&amp;signature=KJOxWs5l0IhTPhEsbi-S8YOPV5ADosbu9y56wc96yxqvBhiz-c9wxHTbh2zGL7HnglvOravbKMK3btNWhobuUZH1bR**bu3MAnIAipy6jA-uAofdux4bQf0fQKo7d*xg&amp;new=1\" target=\"_blank\">mp.weixin.qq.com</a></p>\n</blockquote>\n<p>本文是使用 golang 实现 redis 系列的第五篇， 将介绍如何使用跳表实现有序集合 (SortedSet) 的相关功能。</p>\n<p>跳表 (skiplist) 是 Redis 中 SortedSet 数据结构的底层实现, 跳表优秀的范围查找能力为<code>ZRange</code>和<code>ZRangeByScore</code>等命令提供了支持。</p>\n<p>本文完整源代码在 Github：<a href=\"https://github.com/HDT3213/godis/tree/master/src/datastruct/sortedset\" target=\"_blank\">https://github.com/HDT3213/godis/tree/master/src/datastruct/sortedset</a></p>\n<h2 id=\"结构定义\">结构定义<a title=\"#结构定义\" href=\"#结构定义\"></a></h2>\n<p>实现<code>ZRange</code>命令最简单的数据结构是有序链表:</p>\n<p><img src=\"data:image/png;base64,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\" alt=\"\" loading=\"lazy\">img</p>\n<p>在有序链表上实现<code>ZRange key start end</code>命令需要进行<code>end</code>次查询, 即时间复杂度为 <em>O(n)</em></p>\n<p>跳表的优化思路是添加上层链表，上层链表中会跳过一些节点。如图所示:</p>\n<p><img src=\"data:image/png;base64,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spCVlYWPPvpI6vffXHaPn/lecllZWYiIiEB4eDjq645vI+wS57179yIrKwtHjhypsa6NtdvmatH60Ov1mD9/PsaPH2+1XKPRAKbB4enp6QCAUaNGWW3Tt29fwDTovI1bbfrpVfW7a0YjkrJa3blzBzBduTdr1iy8++670Gq1KC0thVwuR0VFBWC6wvHu3bsoKipCcXEx2rVrBy8vL8hkMsu4Lzc36wnnG6oPb29vfPPNN8jOzkZpaSn0ej0yMjKwbt06/PTTT/Dy8oKbmxtOnjyJRx55BGvXro0YMGDAiOXLl5/cu3fvkPT09HV3797NRNUp1UfbtWvn8swzzzht2LDhpPk19Hr92du3byeZH0KISqPRaKwrHkePHu158OBBWfXH0aNHe9S1/a1btw5qtdpvqy16sdrvD927bVFRUa370el0eO211/B///d/+O6775CRkQFPT08UFhbWOhWJSqVCaWkpFi9eDK1Wi+nTp8Pf3x+ff/45jEYjdDod5s2bZzljcuvWLeTl5SE0NNQGza9Kg8nYjh070L9/f/Tq1QuxsbGW5adOncLIkSPRtWtXzJo1y+pyz4iICPTv3x99+vTB4sWLLd2zqampGD16NPr06YNVq1ZBr9c3uL/PPvsMK1euxLx586S4ker9eAtAJYDFAPLtmVS0EXaPX1paGmC68uadd97BypUrMW7cOEybNs3SZtsgtlPH0qL10adPH/z1r381XwEHANi3bx92796NgIAADBw4EOb7L1efoR1VA6wB02162jJZ0sFYQFTPcJqclGk0GnzwwQc4deoUtm/fjrfffhuurq64ffs2fvOb31iSsaKiIty8eRO3b99GQUEBcnJyUFJSApiG78A0Vsxs37596NOnD1BPfTg7O2Py5MnIzc3FypUrMWvWLKxYsQKVlZWIiorCE088AZjGtwUHB0OtVp9ZuHCh16FDh9qnpqbOSU9PNyelGD9+/PicnJzbb7zxhiwlJSUQAN577z0UFBQcrN6j06H63BH3iIuLQ2lpaca9vUBZWVlZaLxPq/1+tKHPx507d7B7925Mnz4dDz30EP72t79h+vTp6Ny5M7788kvodDrIZDJUVlZaZtcHgHPnzuHVV19Ffn4+zp8/jzlz5uDXX3/Ft99+iz//+c/46quvMGHCBBQUFOD69evIyMiAj48P3njjjYbK32gNDtjauXMnIiIicPjwYbz44ouYMWMGCgsLERQUhAULFmDdunV4//33ERYWhuTkZJw/fx6RkZH4+OOP0bFjR0ydOhXBwcEICwtDaGgoevfujXXr1iEqKsryGjdv3qxzf7m5uQgPD8e4ceOwbNkym73xFhAFYCUA86DCxQAWAdgE4F2pC9cK2D1+eXl5UCgUiIuLw6RJk3D+/HksW7YMu3fvxqhRo/Dqq69KHZOWwHbqWOxWHwUFBVi+fDm2bt0KPz8/7N69G66ursjNzQVq6YkxDxSv/qXVHEIdstoGu2kpZwCo7llmTsreqDamrN6dODk5YeHChXB1dbUs8/T0tFzBN3PmTKxfvx5lZWXo3Lkz5HK5ZcyYVquFj4+P5R/B6lNU9O3b15KE1VcfMpkMEyZMwIQJE+otZ15eHvLy8obWtX7hwoULlUrllrt373bLzs5+MS0tbVt8fLzvvb1y8+bNQ3FxsdVArNLS0tKMjIyc7du3d9fpdDX2rVAoMHv2bEvyWZ+ioqLtKSkpLxsMBhcArnV9PvLz87FlyxYcO3YMPXr0wIIFCzB+/HhLQtu1a1eEhYXh+++/xz/+8Q/069cPO3bswNy5cy29xv369UN4eDiWLl0K8x0EduzYgQ4dOqCkpARRUVHQ6XTYuXMnKisrkZ2dja+//hrz589vTruzaDAZ27x5M8aMGYPRo0cjOjoaGRkZSExMhI+PD6KioiCTydC1a1f07dsXN27cgIuLC/bs2YOgoCBkZ2dDpVLh3LlzGDBgANLT03Hy5EkolUr4+/tb/lv74osv6twfTAeF+Pj4xlw+7EjjEsyfxiUA2tplYvaIc4vH76OPPrI6TTZ48GCEh4fj4MGDSExMbMlkjO3UPhwpzo3VIvWRlJSEKVOmWE5bRkREWKZSMJ960Wg06NWrl+U5hYVVY9k7derUxFetYZUN9iEFU1LW7sWGNjSfSqzLiBEjMHr0aPznP/+xxN/Z2RkeHh7Q6/UoKyuzfM9VVlaiXbt2iImJwbx58/Ddd98Btq2POj8fZ86cgYeHBwwGA8rLy//92GOP4cknn8S1a9csp2IBYNu2bfD390dZWdkmU4KEkydP4vHHH8fAgQNx5cqVWmes37JlC/z9/VFRUfEt6nHq1CmMHj0affv2helsaK2fj3bt2sHJyQnvvvsufvOb39Q615qzszOmTJmCyZMn4/z58xg+fDhGjBgBmG51lJOTA6PRiJdfftnynM6dOyM5ORnPPPMMxowZA4VCAYVCgfDwcMyePRvh4eF47bXXbDL/WIPJmDlDNDccg8GAtLQ0ZGdn10iOtFotOnTogIiICAwfPtwya/CkSZMsswMrlUrgnrvc17c/VA3ia+x9uqS+Ea0WgHk+hDJTYzdn8M9JXDZbaqk42zV++fn5kMvllrYNAIMGDQKARv3X1gxsp/YhdZwbq0XrY+/evQgLC0NgYCBiY2MxePBgq/Xm05OZmZmWLycAuH69aoaD7t272+p9rmmB2NWWUDSm3u993uMAnq1jWx2ASKA8EsDt5hRWpVIhLS0NL7zwgtX9E809aUaj0fLFXlFRgcuXL2Pu3LlAy9RHvXEqLi62/F5eXo7jx4/Xut2PP/5YY1lRUVGd25s19vR3UVGR9tSpU/V+Pry8vLB8+fLGvWmZDIGBgVY5yMqVK9GxY0eo1Wqrf0hgurOB0WjEkiVLrO4hOm/ePERERCAlJQVBQUHNrowGk7HaMj4vLy8MHToUSaYu2/LycqSmpiIgIADLli3D1atXkZmZCZVKhWnTpgEAevbsiStXrlims8jOzm7U/lqRP5kGGN7bWPQ22PeDwK7xq6iogLe3N9RqNQ4fPmxZbv7dfMPYNojt1LG0aH0UFRUhLCwMAQEBOHHiRK237jHfmichIQEzZ84ETJ+PXbt2YciQITabZ0yWdMBhT1MK9djMWnITUxJWFtncecjMzD1nTk5OSE1NRXR0NH73u99hyJAhKCsrg9FoxNq1a7Fx40acO3fOchxqifpoJexyvDpx4gRgmr/sXub5Ji9evGiVjF26dMlqfXM1aZKv4OBgrFu3DikpKRg6dCiioqKwefNm5OTk4OrVq3jiiSegUqnw888/IzExEX379sWIESOgUCiwdetWzJ07F1u2bGnU/lqRDQCcAXzIL7cmsWv8XFxcMGfOHMTGxmLp0qWYPn068vLysHDhQgDAa6+9JnU8WgrbqWNp0fpISUkBTD0yGzdurLF+1qxZ8PX1xeTJk7Fz50706dMHI0aMQHR0NPLy8vDJJ59IHZ8WVzXxq6z6eDGbJ2FmPXv2xOzZs7F9+3Z4e3tj6tSpiI+Px+TJkzF27Fjs3r0bGzZswKVLlxAYGIiRI0di2bJl+PTTTx+Y+riHXY5X5o6g6jcXNxs7diwAYMWKFdDpdBgxYgSOHDmCPXv2YPjw4fDz87NZOWqd9+LeecYqKioEAHH27FkhhBCLFy82zx0jvL29xaFDh4QQQuzfv18oFAqhUCiEn5+fmD9/vgAgzpw5I/7yl79YnjN8+HChUCga3N/69evFzJkzGzVPR8u1h0ax+zxZ1X366aecZ+w+6XQ68fLLL1vmujK3vf3797fG+DlknC9duiQAiA0bNtS6vqXarQPE2SHqIyIiwtK2a3skJycLIYQoKioSwcHBVuuqzw3Xluuj2jxjhUIdsro584w1xq1bt8TUqVOtYj1hwgSRl5dn2eZBro972OV4NWTIEKFQKKzmZ6suPj5e+Pj4WNXH8OHDbTYPKwAhq3Y3hPuWn5+Pmzdvwt/f3+pKHIPBgNzcXPj6+kImkyE/Px+dOnWCs7MztFotdDod/Pz8agyyq2t/jWHalyOPEWlynB2JhHFusfhVVFTg9OnT6Ny5M1QqVYveDJbt1D5aQZwby671kZOTg6ysLAwePNjq5tXN5aj1YeoVi7yPnjCb1Udubi4yMzPh6+tb5z0nH7T6aAK7fT4MBgMuX76MgoIC9OjRA35+fo0dy94gmUyGZiVjjqQVNC7GuXkYP/tgnB0L66MFNeHelKwPx9Jm6oPJmP0wzs3D+NkH4+xYWB+OhfXhWNpMffB2SEREREQSYjJGREREJCEmY0REREQSYjJGREREJCEmY0REREQSYjJGREREJCEmY0REREQScpHL5cUajcajW7duUpelyTQaDeRyeXFpaanURanXvXccoPvD+NkH4+xYWB+OhfXhWNpKfTi5u7ufSEhIkLoczZKQkAB3d/cTUpejAbI29GD8Wl/8GOfWSeoYsj5YH45M6hjatD4mqlQqnc3uQCoBlUqlAzBR6lZBREREdL+cAMTrdLp9oaGhRVIXpilCQ0OLdDrdPgDxUpeFiIiIqMm8vLx2qFQqXUxMjMjNzZW6s6teubm5IiYmRqhUKp2Xl9cOqWNHREREZCsTlUrlQblcrgcgHPUhl8v1SqXyIE9NEhERUWv3/wHjmy5JogZBsgAAAABJRU5ErkJggg==\" alt=\"\" loading=\"lazy\">img</p>\n<p>在有两层的跳表中，搜索的时间复杂度降低为了 <em>O(n / 2)</em>。以此类推在有 log2(n) 层的跳表中，搜索元素的时间复杂度为 <em>O(log n)</em>。</p>\n<p>了解数据结构之后，可以定义相关的类型了:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; 对外的元素抽象</span><br><span class=\"line\">type Element struct &#123;</span><br><span class=\"line\">    Member string</span><br><span class=\"line\">    Score  float64</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">type Node struct &#123;</span><br><span class=\"line\">    Element &#x2F;&#x2F; 元素的名称和 score</span><br><span class=\"line\">    backward *Node &#x2F;&#x2F; 后向指针</span><br><span class=\"line\">    level []*Level &#x2F;&#x2F; 前向指针, level[0] 为最下层</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; 节点中每一层的抽象</span><br><span class=\"line\">type Level struct &#123;</span><br><span class=\"line\">    forward *Node &#x2F;&#x2F; 指向同层中的下一个节点</span><br><span class=\"line\">    span int64 &#x2F;&#x2F; 到 forward 跳过的节点数</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F; 跳表的定义</span><br><span class=\"line\">type skiplist struct &#123;</span><br><span class=\"line\">    header *Node</span><br><span class=\"line\">    tail *Node</span><br><span class=\"line\">    length int64</span><br><span class=\"line\">    level int16</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>用一张图来表示一下:</p>\n<p><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsoAAAGnCAQAAAAEHbnSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAD0zSURBVHja7d13fBTV+sfxz2wKPUjvvWmQhN0NKE2ioIgIKoriVa8Fxave67UXbFhQxF4RC78r2FBREQUFFRAUELKhiUgvUkKVFkjb8/sjmyVVCdlkJpvvm5cvZs7MnH3OyfhwcnYKiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIVCyW3QFIXh5jdwRO4NN5KRWWy+4ARETkmEi7A5CCkuwOwFZeuwMQsZVGyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyvKXdnHE7hBEKhQl5bC3jot4MU/Jz1zE9uM61s+5TLG7ASIVipJy2EtjMxP5KVdJKpvJsDssESmUknKF0IxH2W93ECJyHPSQ+wrh37zAKMYUsiWVhazhJOI4OVfpYlZQk+7Uy1W2k0VspiUeGtjdHJEwppFyhVCDx/iBrwqUr+YKHmM5X3AVz5AJQDoPcAtzmMPVLA/u+SNDeJuVPM4lzLK7OSJhTCPlCsLLFYzBS6NcZencQWMmUh2Yx9004J/Au8ziDdzATu4N7LmNexnMXVik8hb3MYWGdjdIJExppFxh3EJDHsGfq2QKKTxMdQB6cjpvk4mf90jADUB9rgzsOR4/w7CAqgwjgg/tboxI2NJIucKI5nH+yftcFSxZRXOaBtd68CN/EMUhugbLEgJ//04L5gdLW7LK7saIhC0l5QqkAzfyOt2C63uomWtra2APVYDmwbIqgV+l9pCZ63rl6tS1uykiYUtJuUK5hrk8yNWBtab8kGvbYqAp0cBSzgiULQtMdzTlT960O3iRCkFzyhWKi8f4g3cCa91IYWFw2zxaUp9atGJxsGxB4G8361gbWN5LH963uyEiYUtJuYJpxu1sCCz3oAcjmEc6KTzFb9yJBdzEr7zGn6Qzk5lUBuBq6vIk68ngF0ZQg0vtboZI2NL0RYVzMXOCN10/y3PciR8/DXgt8AVfH0YxmvFE0JDnuRGAqoxnJENw4SeOZ4myuxEiYcuyOwDJy2MgqUw/MYP1nJTvLj3DZqJonG/PA2yhEbVLOR4v4NN5KRWWRsoVXhQdCpRZtChkzxg62h2sSNjTnLKIiIMoKYuIOIiSsoiIgygpi4g4iJKyiIiDKCmLiDiIkrKIiIMoKYuIOIiSsoiIgygpi4g4iJKyiIiDKCmLiDiIkrKIiIMoKYuIOIge3RkWvHYHkEfZPg9aJLxopCwi4iAaKYcNZ4xPnTVmFyl/NFIWEXEQJWUREQdRUhYRcRAlZRERB1FSDjsTyCrG3il8ZXfAIpKLknLYeYWMYuy9nY/tDlhEclFSFhFxECXlMJXO81zKtXwKfM6kQOlTLAOSuInB3E+K3UGKSAFKymFqBAd4iXuYzmTa8C4G2Mp02rOKEVzG//AyrFgTHSJSFpSUw9Jm5nMnjTiFG5hEHJXxAd9wNpWZyEASieES6jHH7kBFJB/dZh2WNgM3AmDYh59BTMfLNzwIbGYFPwNwgB3UtTtUEclDSTks1aYSE4gE0tmJi/O4nAvJIh6ozblcAcBOqrLW7lBFJA9NX4SldtQMXH/8KpOB+sTyGIMA6MtX7Ad2cA1pdgcqIvlopByWohjN/Uwgmo7cAcAgRjAAgPNZywDa4eIe6rDF7lBFJA/L7gAkL485kYdwegt9dGcKtYkqdP80DpbSbLK3xA8R9QI+nZdSYWmkHMYaFLmlEpXsDk5ECqU5ZRERB1FSFhFxECVlEREHUVKWoFkMdsib/kQqLn3RJwDs5X0m4Oeo3YGIVHAaKQuwjvNYzZN2hyEiGikLQGWeoRer7Q5DRJSUBaAJTewOQURA0xciIs6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iC6eUSC2utxRCK200hZRMRBlJRFRBxESVlExEE0pywiIeEZaXcEZcdXim1VUhaR0HjE7gDKkJKyiJQHw+0OoAy8Wcr1KymLSMjcaHcAZaC0k7K+6BMRcRAlZRERB1FSFhFxECVlEREHUVIWEXEQJWUREQdRUhYRcRAlZRERB9HNI2FjnN0BiEgIKCmHjdK+z0hEyoKSclioCE8cEKkYlJTDQkV44oDI8UnlCHXsDqIE9EWfiDjOKIbwR56SW3nhOI99l0vsDr9ElJRFxHF2sp6H8ecq2cFuu4MqI0rKIuJA9fmN/9kdhC00pywiDtSIf/Ii3Tm5kG2rWcYe2nIa1YNlu1jIdjrjzrWfYTG/EkkHvOVo/KmkLCKONJQ5PMgHROcp9fMaE2hLPT6mKqPpCEASd1GZWGbRhFaBPVN5iPnEs5v19GRUrgTubOXnnw8RqVAsHmUXL+cr/YyJPMWHvMxUWnE7qcAh7qILU3iOD4jjk8CeL5LER4zlE95nVYF6nEtJWUQcqgH38hELc5UYxnEefQGoys3s4WPgcw5wdWBEfSX1AUjhc86nOQAnM4ip7Le7OcdJ0xci4ljnMYdHmUSNwPpO9tI9uLUDtfkdWEsNTgmUWXiZDqzBTzW+DpRGk846PHY357goKYuIg41gCKMZFVjbC9QMbrNozR7gT5rk+qU/e+54D7CQ5GCplwy7m3KclJRFxMFq8gi3ckZgrSmwPbgtneWcCzRiPqlUDZQmB/e8MjDRUb5oTllEHK0HFzOafQDUoCNfBrcsIo3TAA9ZLAmUpbIMgHZU5dvgnq/Tn1S7G3KclJRFxOFupyZ7A8t3soJH2EE6C3iMeM4B+tKep1mOnx3cTwMAYhjOj3xKKil8xLvcFBxJO52mL0TE4arwGMMCy/G8xUMMwIXFedyLBbgYx4Nci4sIBtODsQBcSRQvMRpDZW5goN2NOG6W3QFIXh4DSXYHYSsv4NN5WQ6V5bm7i720yndbyWG20LrArSabyaI5USH87NI+QzVSFpFypx71CpRVK+SWbBct7Q612DSnLCLiIErKIiIOoqQsIuIgSsoiIg5ygl/0dahRo21mzRM71m6R+w+u/f2g3VGIiBTmBJJywqn+x7nQX24H2X6q4fnC9dDiFXZHIiKSX7GTclx9/0/ERNOMk+yO/QT9yRbSL/SfFddu2U67YxERyavYSTnycWLO5AFq2R15CexjFLNiIh/nRrsjERHJq/hzEN3hhnKdkqEWNwRaIiLiLMVPyu2gmd1Rl1izQEtESo+7cVw1Oz8/rlqi7tgth4qflCtRbp62VLSqgZZIxeC50vONZ7V3dJl+qMvaGjUsBPWcEPd1njWRBw+ken5O6GFXDHJiyuslFCLHzeNlIpvM0/5pdkdSVrwPWW+aD+jOLWT6Z3m8dscjxaFfbyTsmUHsTf4Xxu44ykqXZlkPmFHJjwAL4j6I3M7DXGB3THL8lJQlrHn6mUqWx2S4B0LE74t/Byz3WZbHuFzJSd/hB0hw+6v75rq7WeewzGRZK31rAXrUSD3T9XPSboAuzTLdrjlJ+yG2epXunM5+M8+XBOBt7u/c9uv1Lc3F1qGk1wG8Z3Ka2RPxzaKthUcU3zHiHA5nzly2AcBb1d/X/BhVOasvbaylGTOXHc7Zr0vDrDOsTmZzxDeLtmRHmRWTPMfTy/R2HeTbpFVFtzmzp1Up8u3s5WWHvV+Z0+z+KUhxKCmHBWf9fuqo50GPseoRY1XmDch6lt+71sl8j0QWWX7ziGdB1OULU8B/u+ng9Zl/ccAstDpYvzAE4MgF1kTu4jmArHutq/bXB8/tPGNS8NGVet5RSQ+Bv6/1zrrrGM8hE83rbSvVGG+GsJg9WSMTLvUXCKZLs6yZNGMhNSPHemb6zgVXQzOF67OeMOvYz38jt3S+YMlG8EaZiVmX8pvZzJ1ZWe4rkr8E/+1WnGch/7CWm9PIdP8jeXJRTbYO8r9Ff+SsmcZssvuHUJhxvGl3CLkMd9D1sUrKEtZ88eB+yTUwqXX2eubrdMpKWPoreNpaM9LHMwDA6mSqWm2T1iVWPvC4uTE2emU6mP7WPtM/OykzkClr0xI6+J/ndd8tgMv7jHnA84HvNwBGuc5ZPDOxMtS811xEH99ciG/CJwWjybqTZiY2eRN44vC5+ydPB7BeMhckfw9x9SNnut6nB5hrucy6NOkT8FY1M62xTMUA8ayKarLwQJdmWTNcLzIZujRMy/d/cObOlem+r/gqZz3hbH9vc5PdPwUpDiXlsOGM8amzxuz5xXfkUuuapb8C+Na6X7We856WtBCozBVJ62D2Ufck664qiczAZfXjYZ6Lrb7ykDue5tYksFIZWin7rZ1+3uIO04XspPzk4pkw++iQiHV3mFnJcwGWbnU/Z32a//ONZWVERgD4lrn7uQ4Fihcmfw+wbKd7rDXW2zNpnmuRf2DSVwBJqe6J1lhvs6TNAFmP+w7Aoi3uT3ioS8NFO/xzItvn/YTIM5h7bM3Tzz/JzEweZ3e/F8UZ41NnjdmVlKVCiXBD5Dc5a9Z0nvO7WQhs8mW/ApnkxZ51ZiAzPF2JPvpm5Tuj+zCFgexjBizawqS4Vp4eVjNT3UQCdbOPMVOz//69eWRNvs+pPWp2ZoHPj3w265yslZ5v+TpzWnJwTzMjGN8sPyaeeYuTSe7cJSKexv7KrpYG6rIZ+C37nxPgR8hoyA56ROT7P9i/J2dpSMS6x7if92veUHG+4gwPSspSgVgNDFWCaStmzYF0qyGAyfUUFPOx9Q/+Y/pbM1eme6a5+jPFGsTnSRkwJGLdm1xjbTM/sZ1cGbdy4OiIOmCtySndeyimwKTyoi2JnQ6ez/nmwchxnm8irl20A8BaGvzs9WSa+uCuZ02lKyvNQmu/OfY2uKPBpXSIcEH215CFiW+y7iPc5prkCXb3uRSXkrJUJOvgYAvWZa/s72FFm3UF9pnE/e546zwzFqxp5nVvI5NgPQiw9r/WdQxNmgTQo8aRuwocuQlMdwLj5prdTSF3AczO5Au+gM7dXR9mTaI3gGmSs9XqaiKtjWC9Q7y/9ZKNAJ7zGVpUczxX5H8umPVZ0nbwtjHfW366+Zbb3eFSfErKUoFEzs84ZK7jgew16zzS+TH/PslLPatcw4w7chowi/rmXnbX+AHA6sl636TsvVKvKPg64+Rdnt+sM3PW/GcX3MPzE3t8gwCW/OydYq4LxHEF7wSO6YvfPw/oyYfZKRm48i8adDEt8hZYP7Mdl3kfV4T3lz1IOaSkLBXIwhTP4zzp2V3p3SP+iMvNbTybXNjlYpPMAyxZtAOSUj1zuMV6O3t62Ky3LvD08830VuYmcz2HCh5oHrI+8YyyXqhx6MAgLiU1/3brc/OM+7qsr6LSOM380ywKFFd1P5s5qvrRowO4nQlL1gDr6RPffulqbyMzilOKbo9vcGGl7sGcZsZm9Qp+6ZqR9LXdPS/HT7dZh50JZBVj75RjV09VCL4x3MLItD2uvWYM9/keKHSnSUSaQBqzphFpBUbHrsf5lE89f5ptpmdm78KScvJk8w9uMrsOHLRGWxcVTMpJz1vPW69Hpph95luWZQVGyv6nrEpR29IOWh+aD6zhAK4bzPqIlZ59xmfty/pHcdtodQXrJvN58M97dvf68VhWzOuHZrC1WPuXH1ZxD/AYp1x8VTJewFfs1pe+E+tfb65L4rowl8rHfeQSnieU3wV5S3xxXhn8ZKz4dpGupNX4i39oYuUD7WNWFnJhRZ7arfTg5EMBsdUrtzbRkX9kf8nXpXXWOnNB8pfeqlaHqFXzjxzbr2udtDpLV5dqP4RY8c7dcbyZ55K4tznMf4vxaTdxJaF51lL+SP5OaZ+hmr6QiseceLKbfZRlJat95aHCakhKJTlvyS970JxwhaTpizCVzvNcyrV8CnxO4PdvnmIZkMRNDOZ+UuwOUqSAY2fnEW4l+w3HS3kq3zkdzpSUw9QIDvAS9zCdybThXQywlem0ZxUjuIz/4WUYGXaHWeFZ+3kpYr3dUThH7rMzkqzAvTifUS/fOR3OlJTD0mbmcyeNOIUbmEQclfEB33A2lZnIQBKJ4RLqMcfuQCu8X/b4btN71Y/Je3YOYhqQxhzOz3dOhzPNKYelzRD44sKwDz+DmI6Xb3gQ2MwKfgbgADty7hQWcYS8Z+eljCaFZcTSkHn5zunwpaQclmpTiQlEAunsxMV5XM6FZBEP1OZcrgBgJ1VZa3eoIrnkPTujOYcZLGFQIed0+ArntlVg7agZuP74VSYD9YnlMQYB0Jev2A/s4BrS7A5UJI/8Z+dAPmcZZxVyTocvjZTDUhSjuZ8JRNOROwAYxIjsRwdzPmsZQDtc3EMdttgdqkguec9OOBUXZxFd6DkdrpSUw072vbsd+IwUahMVKD2bswNLFrdzMwcDs8mdQ3rriMiJuh4KnJ1Argvg8p7TY+0OuNQoKYexBkVuqUQlu4MTKcJfnZ0NilVT+aQ5ZRERBynlpHyUXSF67UFq2Nxz6u4bV83uGERK3x422B1CuVTK0xff8hg/Eooc9C4fM6useqVUWTMjF3sX+xdFzfrFYefsLF7hAYe/ZU/Kj2+ZQCyxxNK9FGp/PvfLCGnE63Y3N2Q0p2yHBJNg/Stzp3exf7FrWtJCu8MB2Mv7TMCf641DIiUzm13MYQ7QnljiOJuqIax9NbWyX9wCQIzdjQ0hJWX71DfnWeeZh72/+hfzWfKXdoayjivowpPcZ3efSFhazWq+4EViSeBsmoakzt2cy9V2N6xUlElS3sJ8DtI51y/GO1nEZlriyfVtairLWE51Oud61cIuFrKdzrhz1WZYzK9E0gFvYEp8IfVoxk+sJpH2xxkTQOfEsmj93zEdrY5c7TnCCub4Z9sTQ2WeoRehenhvyZ+37YyfjBRf7p/9wXzbDrCABbxKAzrhZXsJP2l32D4ioAyS8nyepzXJHOUa/gPAjzxEbZoykQgeI/ulZu/zInU4mV/ZxzBuAiCJu6hMLLNoQqtAbak8xHzi2c16ejKK6sCjnEkya6hEZLGSsstJk9RV6EIX110Am2lexh/ehCYhqCXH8BLX4KifjBTD8fzsU0jhOwA2HsfehUvnIPXYThJ7aUW3sPqVvwzaMp6PiOEwI5nAYJqwjXsZzF1YpPIW9zGFhmzieYZwH+DnJd7hXFpxiLvowhNEAxMZH6jtRZL4iObAKv7Ly4wA4HN68xbVSC9RpKZMxqnW344CyzolO1HZ/CzkRP39WXw8Wp7wkbuBOdxHK2A1LXiWZnZ3SciUQVI+jxigGhfyA7/ThPH4GYYFVGUYk/iQ26nMU4FJexcX8R6/0orPOcDVRANwJV+xE0jhcy4LJK2TGcR73EJN4CQeJRoCex8ve14H5Sn8GsGF1qf+T5I3eUJzBaGtHP86KCkV+V8HNbzQM6E6Z9GXHozjzRJ81h5gFV8TA6zn3zxeotqcpQyScs47193AXuB3WjA/uLUlq4AGnMNWlpJCKlnAn8BaagRnly28TAfW4KcaOa/mjSaddXiArsVMx47yG5/7P1myxO4wREqXRSJ96Bu89b8kWvA27QMX27bmFh5mQ3CKs7wrg6R8Ur6P2kMmU4Jbq1MX8PMEU6lHPHWJCGz5kya57m2pHjgWFuZ6mZk38O6M2nb344nZyhQm+36wOwyR0taVRPpSJ2T1xeT58j8O2KikfOKa8meBXzU+YApPcQ4AqUwEoBHzSQ1e2ZgcOBaupK+9fRYKB/jSTEkO95eNidCR3pwV8oS5hF+5PDhoOwIhuUXNGWx49oWbdcFHq++lD+8DS2gSSMkwLfC3hyxyfqdPDbwAuB1V+TZY0+v0J9XO3jsh1hQzzN/Cd5VSsoS3PlzNeCYwrBTGsPt4PpgpYBrRnGx3c0PGhqR8NXV5kvVk8AsjqMGlQBO2Mx8/R3mPDwOj476052mW42cH9weuZ45hOD/yKamk8BHvclNI7xEqG0kXJo9f8qfdUYiUtsu4lfhSqrsHHXmdL9jJVl7jfW4Lo3v6bJi+qMp4RjIEF37ieJYo4AZSuAdwkcBbDAXAxTge5FpcRDCYHoHnp15JFC8xGkNlbmCg3f0nIjaI5kWe4wkMUJuHAm/VCQ+lnJQv4ILgcnTwApkmvMUBttAo+AVddUaTziZaEwHMCJTG8DKH2UJrooFLAbAYyqVsJovmwW9xpxUjIila+xDciydSNmozivv4gxgaE15XUNp2I0wMHfOVRNOukP2qFTJX5CrBReciEi5q5HokQ/jQQ+5FRBxESVlExEGUlEVEHERJWUTEQZSURUQcRElZRMRBlJRFRBxESVlExEGUlEVEHERJWUTEQZSURUQcRElZRMRBlJRFRBxESVlExEFse3SnhNo4uwMQKTadtQUpKYeNN0NQh0hZ0jlbGCXlsDDc7gBEik1nbeGUlMPCjXYHIFJMOmeLoi/6REQcRCNlkXw8IwEwEHwjpznOpaL3KFhX7rIy4RtZ9n0pxaekLJLfI3YHUEqUlMuF4iflbTTeTiO74y6h7dktESlCuH0Jpescyo/iJ+W1NJ7DULvjLqE52S0RKUK4fQ2lpFx+FD8pv84Zz7CPdtSyO/YTtI81vJ3dEhERhyl2UvZN8pzJjW/bHXfJjfNNsjsEEZH8TuCLPt+/PB/Tn7bmJLuDPzHWn6xluu8Hu+MQESnohK6+8P2AUpqISCnQzSMiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQs4gi7OGJ3COIISsoiIbKOi3gxT8nPXJT9nJW/5edcptjdAHEEJWWREEljMxP5KVdJKpvJsDssKWeUlEVCqBmPst/uIKRc0/OURULo37zAKMYUsiWVhazhJOI4OVfpYlZQk+7Uy1W2k0VspiUeGtjdHLGBRsoiIVSDx/iBrwqUr+YKHmM5X3AVz5AJQDoPcAtzmMPVLA/u+SNDeJuVPM4lzLK7OWIDjZRFQsrLFYzBm+dFEOncQWMmUh2Yx9004J/Au8ziDdzATu4N7LmNexnMXVik8hb3MYWGdjdIyphGyiIhdgsNeQR/rpIppPAw1QHoyem8TSZ+3iMBNwD1uTKw53j8DMMCqjKMCD60uzFS5jRSFgmxaB7nn7zPVcGSVTSnaXCtBz/yB1EcomuwLCHw9++0YH6wtCWr7G6MlDklZZGQ68CNvE634Poeauba2hrYQxWgebCsSuCX1j1k5rpeuTp17W6KlDklZZFScA1zeZCrA2tN8zyAfDHQlGhgKWcEypYFpjua8qfep1fBaU5ZpBS4eIw/eCew1o0UFga3zaMl9alFKxYHyxYE/nazLvhG37304X27GyJlTklZpFQ043Y2BJZ70IMRzCOdFJ7iN+7EAm7iV17jT9KZyUwqA3A1dXmS9WTwCyOowaV2N0PKnKYvRErJxcwJ3nT9LM9xJ378NOC1wBd8fRjFaMYTQUOe50YAqjKekQzBhZ84niXK7kZImbPsDkDy8hhIsjsIW3kBn63nZWn9DDJYz0n57tIzbCaKxvn2PMAWGlE7hJ9dFr1aUc7d0u5LjZRFykgUHQqUWbQoZM8YOtodrNhGc8oiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqI7+sKI1+4A8gjvG27HOeoBm8MDT84on3Te5qWRsoiIg2ikHGbs/3cex419SoszxqfOGrOfKJ23x2ikLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqKkHLaWFfMyoxlstTvkvxDX1HOut25o6/Rc2rldKOoJr562m3pTSTls/cK8Yu3/ORvtDrlInmsiZ3Gp1TC0tZrriQ1FPeHU0/ZTb+rmESkPLrZGJH1idxAiZUFJOewl8TYpdOA2YriXUdQAljKN+0nnVRZQjQFcYneQf8F7ofmX6UJjzzDrlqQN3nvMxURZ3+x/ZG2at425x8yy7jI/We2qXPbTQfB+wmNJy8HzjGvG4pneW/3nWzHWp/wvabdnMI1NfesSRvo+9txgrreyzPPqaSeruL2p6Yswt4oRXMb/8DKMSLL4HoDPqAeM4AAvcQ/TmWx3mH8ha3bWrdYaxmXduv8P9xjTM+r8jDOpW2MiWDEM5d88wDgTk9oPPHHmXC6CuGrcbC13X2wuc10fOcC0NY8ALRjpast1mT+7+1t3uZ7KGmL1tU5VTztVRe5NJeUwN5GBJBLDJdRjDoOYBqQxh/PZzHzupBGncAOT7A7zLyz5c+lqUq2tS1fXc1m3+h9cmLJ8X/Q91uC4VkCMudb3bfJKJrkGgunPaNMPIs9h4aIdrkWVBiZt/mVP1vNcAGAdSbrCt2DZHww2zyd9sXTr0buoo552qorcm5q+CHObWcHPABxgB5cymhSWEUtD5kHggTqGffjtDvQ4pLXk8JKlAPP3epdHtmcn65esAXB9ah4cErH23KwrIwZ0rZM5kEkQmZZ2r+c0U8WKoC6AmYEBsPryCsDKQ55f1NNOVZF7U0k5zNXmXK4AYCdVieYcZrCEQUBtKjGBSCCdneXiV6ZKKWknxTVZ9gfERpu2/hSXxdHsLUnb3SvXn2tVW7rV821mf/pZ90DGe6w40G9tWufOruz/uwP7WkvpwDLAor162qkqcm+GY5skl758xX5gB9eQBgzkc5ZxFtCOmnwFwKvlZG5u/l6mRwwHqHQlG9otz7NxknmOGeCfxoOsSNoNNLG+XJsWW931WN5a/F+aoVjguYJ6oYwunHrafhW5NzVSDnPns5YBtMPFPdQBTsXFWUQDUYzmfiYQTUfusDvM4xRxXdYH3mR/uhWZdcknWQm5N03mVfM1LFnsqcXTAOYx6w3PBprzAH1z7+j6iP6elWSwmanqaaeqyL1p2R2A5OUxJ/7Ab28RDwtP4yBF3QyXQm2iQt4KbwkeW+4FfH9xXnatY6IW7TiemoZErG2QvK2wLZ1PsqKSdxV13PH8DMbxZiEPuS/7ni4qkvz+rldD4UTP3fJ23pZ2X2qkXAFUolKR2xrYHVyx/bLnePf8JItthW9Z8mfpxBZePW23itqbmlMWKdQeNpT6Z2TmfPsY5n7hiN0hlCMaKUs+s3iFBxzytjI7fcsEYokllu6lUv8ynmU1mTRhGIPsbmwpuynQkwk0CXndW/l3nvXb6G13c0tISVly2cv7TMBfQcZvf202u5jDHKA9scRxNlVDWPtibqIPt3KI73iMVIba3dxStpKVQC1iiaUHnUJY8042c2OuiY5mdje1xJSUJWgdV9CFJ7nP7kAcZjWr+YIXiSWBs2kakjqfxs1oABLZxVguqxDfue/jJ37iLdoQy1mcEZI6dxPB9WE1D6ukLEGVeYZerA5RbSV5aXznRLv7IomD+UoOsIAFvEoDOuFle4lq3816jl0+3Y/F7CzRV1fbj6u3y6JXj++nvo51TKUSbUgo8UTZbuqEVUpWUpZcmoR0xm94CY51zbK7L4qOPoUUvgMowXN8j3A+x56GtIvoEj6GY+pxXXJdFr1anJ96GitZyQQANtP8BD9xN/Xw8wtrqIGbFqXfxFKnpCxl7q/HRkmAmW1nfFYieFldYKycX8sT/oRmPBpc3sskEkvpf8RjPV0WvZrdb4X5+/HziaZk2I2f4WyiDZvYw40MK91GlgElZSklJbl5JPlMOyP3GHiT4YW2oDpn0ZcejOPNkHzWH9xONHeXsJbju3mktHs1u9+K+vSCTqUvfWlUwgmMPfzOI5wP+HmF14mjS+k2s9QpKYscF4tE+tA3pPeRzeRxmvE/atvduDLWijPpS4eQ1PUfbqcNAC7+w2wmKymLhL+uJNI3tI9fJp3nmMwV/LtUbr52qvr0pk9I02bu1O6iI2vtbmKJKSmL/IWO9OYsWoW83jRuZylPcbbdDSwz1ehNIn1CXKufD4gjLrh+hGp2N7TElJRFCtWHU+lNfCnVPpZFvJMrmYS33iRyJjVKoWYXX/Epk4kAYBeLudjuxpaYkrJIoS4rxbr38j7x7OXY5RBdwmCEV7SQv6M2lxu4l8cZSHtW8hw1dfWFiBTfb/hJJjlXyYehfQ1KBdKHUbwcuE77TO4Kg3/clJQln/YluhevPPA2N9V8v9kZQY+w7+Oy1I+z2c5+Wob06ST2Ca/7E0X+jtX5An+ydZPdYUgouWhCbJikZI2UpYLxvmX8fGB3FCJFU1KWcsF9lfUPGpgfssYs2+kZbGq5WppB7DNPJ0+HuGqRI+nJfvO+66OkDM9IljKYeL6MeLXga6Oi75m/1/twkW8ZErGdkrKUAwmn+kdm9o3ay4jIh/k3LayH/He7EqxT/VPi+y5dHTkaMs6LqmNN9KcyGTfXWtewzjyTdSd3e+u6YnJqSTPLNszfa3dbRP6akrKUA1l1rLqR7Vt/9+tDUe0A2JP8DpDs+TDiQsZkvRG5enkG+zz/Z13AZDAf+GZBwnP+CdxtrsoakFNLRBoDShKFSFlQUpZyIHmOe6h14/q3K09xvQLAj9nl1nzzb8a4qphXPPFY1A7cY7sUwKynOfhe4AW7oxcpDiVlKQe8ddMXLJ8eVy3qVv9PbZtAzvuE/B2sFd2qpH1vXZ90M37PbZyT/0jPuVbn4Epm0rN2t0Tk7+iSOCkPPFGTYdlh/wdk1XMB8d6eENfUGmJNST8JV8Y0/HFNuaPggeYI+3P+mAN2N0Pk72mkLOVA0gzvpZ4l7KeuNXL+EQ+8b+7xvMCpvNP6x0+y3OMif/GkUMV6ygzMf2Ry9rtPRcoNJWUpF5KuT4zc12Dp1sBqum9QXP3M1JWHfEDyXbEja0bP3wuMBd8FgSN2F3U3QdJjx/2xImVOSVnKidmZbM29vmznseWVh+yOTiRUlJSl3LGWmG12xyBSWpSUpdxJsv1d1yKlR1dfiIg4iJKyiIiDaPoizIyzO4AKRb0dKurJY5SUw8ybdgdQgaivQ0d9eYySchgZbncAFYp6O1TUk3kpKYeRG+0OoAJRX4eO+jIvfdEnIuIgSsoiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiIg6ipCwi4iBKyiIiDqKkLCLiIErKIiIOoqQsIuIgSsoiEjLjGGd3COVepN0BiDjRcMBb6p+SxVGq2d3UkHoTr9JyCSkpixQiKfCfFFeS+q2ElJRF8htpEq1EM9uaAxisQKmBXMtWcO+cZVPI1sL2y13TI8Cjdjc3ZB41vYP9JhIuPMZjKjaP8RjbfwojPcYzsmx+2t5Odrc2hO0po34Lb/qiT8QmXg+AudjuOMRZNH3hQPZ+UfITPezugIriLACGoLGl5KKk7EBv2vz5v9rdARWEf4gFEOvp5ZtrdyziHErKTmPz1z7mHKsbK5hsdzeEP28b0zWwOBglZQlSUnYYn82/ynrcgN/uKCoCf/fghRlDuN3uaMQ59EWf5NUR6Nijht1hhD9X9+BiE/cgu6MR51BSllx61KANEJF6od2RhDtvXf+lx9Ys9bcEKSlLLkcCozdriN2RhDt/d6t2rtUhp8XYHZE4hZKy5GJ6BxYGepvbHUt4yzV5AVA9S2NlCVBSllyOjZD9ShKlKDHS5E3K6m8JUlKWIM/ptM1ZtnSfWSna351e+YoucrewOypxBiVlCcozejvDE2d3POHLVchNky6NlQWUlCU3K8+v1LoioPTkn7xAExgSpJtHJMBzCoNzr5vBPGZ3TOHKPEh1ACsRzOzsMmtOl4aLdtgdmdhPSVkCTHfLylMQ7+6drCfjlorkpZwJ4DGQfKbd0YizaPpCAqwCv1JrAkOk7CkpCwDuxhSc51RSFilzSsqSrTsnFyhrmXCB3WGJVDSaUxYA/PNd79ICaGm1NBvZmF1qrJLWKyLFo6QsACzdyjUAnpE8Yr2rR3eK2EXTFyIiDqKkLCLiIErKkpexOwCRik1JWUTEQZSUJS9dbyFiKyVlEREH0SVxIrby6PJDyUNJWcRej9gdgDiLkrKIfR61OwBxHiVlEdvozkkpSF/0iYg4iEbKkpdBXz6J2EhJWQrSV08itlFSlrwsG758MrplRURERERERP5KhN0BiEh+QyIqNTo5Y2PmiR19WoOmEVvTSiey2OimDU4+stFva/eEOV0SJ+I4G1tYW/efc6JHZyzKKLWrZyr3tLYeiLWtYyoEJWUREQdRUhYRcRBdEicnrPNJVlTyrhM71lvVf1Ly9tJ6z4m3brR//l5bOycEYqtX6WvizYqqM346mFPWpWHWGVYnsznim0Vbgq1t4+9ttba2+qckb8tXheXpZ6yMFVHuzLnL9wHEtYo81fdVdr8nuGm0eFphtSa4/dV9c93drHOsxUlfQ1y1qLNNvFnh+k4vpil9GinLCXO9bH17osf6h1pbT6tRWpGZz9Letq1bQuWkKnPN7ZxuvX1kYZfWAN4oz0dZ23jEJPBS1kr3oOzd3MPMr9bdJJinrfXuy3NXkBjpeZfJlqkUbU2J+kd2WdQDfOnxBHppov+/hdfqv9086x1r/cwd/v9Cl2aRP5l36W7dYn6mnt3dEv6UlEWcaYz/bl9vX/+IU8jK/BDAXMtl1mW+jr7+Vl2WWWOxIKGr9TZP+U7xnXu0LlOs8e5g0kysfOAzM4A+vm+S1rGYgdml5lz2mf4AXVqbjmZS4bWC1cn0tNr6atYcBFnvUjkr1tfPdxb/4jm7uyX8KSmLONPU5O8AFu1gnNXVfQa4FjEw6ROApFQzkcbeZuC/n6OVxgCsTI+43yxzubMPPi3mwDeW2+rpWwBgTeLMHjXAHU9d60nrPAD/QDIyPy+8VqAyVyStg9lH3QmcyTtLtwL45vK53d0S/jSnLCWUcGrWOWSYuUuW5JQkRh700otIa9ni6Tmzxt4of1/LgzHJyd/kn0n2tvF3dP3qb2kdzk4h4DnX2pi0iuy5576uX5PWFazVW9XfN2tBtcy0S0wtxifvgoRT/b2p6p95LJLyzDUruDTTjxXHj4uTSe7cJSKexv7KrpYG6rLZivfPnX8ke79F6zktcEj9jFl4OMv3W2D9Y8aknsNkV38z2/+JNbpb7fl7zUBmLN8HhdUKbPItyz7U6gTW9zmxmNnWv+3umXCnkbKUiPd6/zSrl3WDy+cZkV3i6XVgl5lh+ppr/F97ZnqjALo0ND9YH5PI5dY0z09x1XLX4DndLLKGR2+zrmZK9vkY15Tp5pnsrf7zrCn++oXV6mpoTYm6PG0DL1mPm3bguc2/1LqJbq4vPLfZ3SuhYA4El9aTSV1w1/MscC3kNtPCqmwCTwsxDVhcyMFXACt4JbZ69mrSZha4BoHpb75O3sTvR8/x1uQMMwkKrxXMzpwlqw5Erg3WvN/ufgl/SspSEm3MoEodfBf54riVUe7+MCTC+oANR+v5zvWdbF1EH3MdQOY7NPV38p3t60QCXaMeO1aB9xy+s6bGXDj/iDWJ+p6uAJH92cdZbSsBuAayOXlB4bWCedI8asW0qXLSL+4zeMG6J+lU3+Cj7a0edLK7Y0Kgd86C1ZVINoL1DvH+1kmn+ob57uD9wMZNVsPgES7PFfEdAVhQJZGLTNPKE3Me9WRNMud1q033yK+Baa7+/v5kRU+BImrNbRNkdAuu9bK7W8KfkrKURFXzn+xfnn2vscu6G9ZXMv/NvHhlOkDSl2zjNHDHW+eZCUs2AviSzBia5xzuHWKmMjbpmtmZwAz2mewrCs7jdQ7U7A1DIswAPsYUVisA05OfT8r4JGt2pnUPB1q/CLAynVupanfHhEC/nAV/Iln+n4CefJjdi8CVgb/nMaBblexF90W856oDwPyfDvrWchUXeB4O1PEJtdMeZu2i9WBNM+daFzB9YfZYvLBac3EtIMMk5qxZZ9vdLeFPc8pSEhuSNwWWDN9zNiSl8pm3pvsSmlu1rUiTSV0gHkzw4rnkETlLmcPN08zz3Z29lpTh+dwayAhvlOnD0zQx/Zmxvht1zKQiagWsqcFIOjHnk6xATds9q+3umJKzqnueiRxd9fCB87iHCUvWAOvpE99+6WpvIzOKU7L3ing864qjn3b5j3+HOZcn+Dl53rEafFPdT1iPeJcmfQHJ2zxzucW8BMA8qnBJMAEXUmtui7Z43+BW9zLXlPRKkbfT4Pii/9J13ryIxrlLBvWZus7uPi0fNFKWkjhwbNGsptaQCPDeZLZab1l9TQ1/4J98qwGkFzLzaZ7mQ87wXJuzbk3i1LhW9CTN94s1jf5gBrEueTEUViuAPzjzSR1rTa6aw2Dm01xv4jN3HjjIR9a7McMBXDeY9RErPfuMz9qXFbjueNEWurlaZK0zB5nMWusS8jwqKHkk35oJ2VMa1iQiXV8DJGXwHemZX2XvU1itebW+ndes/5kDUbvpZa78u7gBlj8zcH3elAxffm823F/J7l4VCWueCZ4Mb83g2kzPRvB4PX7PazkzmZ7Fni/Bc6nHeINTFu549+Xgvs5jvEPA85rnqDcwGZEY6dnp/a/nGc8E6HySJyOulWeV+0kovNYurT3G3T/46b965ucsd6viOer5zO7eCYXOJyW42+ZJZF3rxLcvuN9pDTp3cZfgto7Ca80tNrpz5261j6+2zN/MxqL+tKtsT0+WJxopS0lEmj7ZC7HRdOdHsHpgWU8HbuM9lXgAs5BMhgSOsKyJ1g2Bg78F6zZ85jNvI4DZmdZkM9Dqz9ew5E9+jriNDtZHUHiteVk/kpBzrUF6L8JkRLbkz8XJa/M8hPOXPUsLmZpZmLJk0Yne8F50rbmtTF+y5PhuXN82NaJK0VtXr6oU0inTGsd9V2h09EMPXXvtX+9zxhlffdWx41/tcdddL74YyvgLozllKYmtjO68o93C9U3MC7iyngCzHrim2zNN09cO8D/LRoDkTZ43zEj3NtcU04LrONUMOFZBUob7Enx81jZxbRpYk8x3xvi/BbCm8zirsq+WLazWfJ7iqsofx92ybFNnr3mJzXZ3TEXV6KRGnQAO+GtOvLvvmCY55dHToisd6gNwaFlUyB796XZ///3Vw6d+2rTpli35t/30U8+eudfT00+OHfHQmgbzRhddX+PGAwZ8Wmvj8MO/FrVHXNxVV31fd2q+SZzTTz/55KKOWLPmp59KpatFCvJM8Ez3DnHv8WR4jGetOyG71P2kZ5vniOegZ35CV8+Hni8BhkS4n/SkebI8xrMrew7ZfZ3HnBYTOOIMT4bnHQBcnu2eOYHa4zzm2Fu1C9aad/oCPHGeVR7jyfDs81zp/SQ8pi/Kn/RV2dMUo14Hq8OxaYuLrcSInOVuf/t7TM2aTz89b97Bgzt2vPdey5ZF7xcVNfWHDP/VT1SteuXNo8wo84fZakYF/txjuszLu3ft2jtTV2RW61B0fUOHGnObOaln0Xt06WLM96Z6XN7SV181RXp/Ts0exetDvbBSSsqKjzX7l/2RuyShY+rGlYfy7uaNMqdY6UfWZ1/YdiKfU1it+T6jkVVn8Ur0XgybJFqzNuQsP/HgA49awTcbrfo4pmbjwEV+o5++f+xf1dKjx4cfNmu2aucGGtU+JSIt48yBvhlF7Vup2nfrEup7r1v1cb1BlrX67R8yntm99sGoiEy/MRm76//x229/9Um9es2b53b3CCZNr/eaaz5jwQtH1mevz569YkXjxoMH5z7mhRfWRn62ePu7OetTp27a9Oqr1w6/MKqwT5jEAu56Z+X1xelFJWURCZHEarN+LXrrbbtennnO7w/1iDnUaGy9NUXtFROzalW1mCdTffUOLju0vE2by7xvH17Y6/CKovavUvOy6Zvje7786H25Syd9MnQo/urV+115yl/8A7CSH3pdf/ozzxS1fcRHL49ynzR37l+1+arXPx3z7N3XDh+YPquGMddc8/zzbdrs2wfPPpuQkJi4Y8fimHs+KF5S1pyyiIRKVFEbZh269ZXl97+Yc8ndYAPcfuaLGwru+cgjjRq9vP+XSssH7Z4KK5jRpskNhwsd71av3rAhwNRLMltt2bm16YVXns/z7APuJ3pIJ//yoYcOffHenD9Obl6zev5jDxz+bRPAoZWcDpcEru1MZAS3k/3vSjPeocHQWnPmvVGrV5e5iYzgXpKDx/flHp5iFsDN1aYCXBTZd9SIBxIS9qU9v/XHO/9v7Omn767lnW33D0REKrTE6oVfCHfzD4s+Laz8zykF61i1Ki3jPNPs1oJbGjYcP37Dhj17pk/v2hXgkkuyZ21HPh9ZG6q2m/jtwbRzTONh9QdlZb11tMNLOcd9803Bmd7Zi6oHbsW/6y5jLjZRdck3p3zyyca8aJr+K3uvyMgNO5ab2n2z1yxr2bItu881DQP/yLz66uH0x48Yc9OnCxZMXvnGriPpZz906NDotadO3LHjq9TYYj7bWyNlEQmVw5kmssCU6NojV+9MOB0gM5hw/FhY1Izf/XXdAbn3rVy5XbstGWlZf4zLX0vbtgsXVqky/Y+syF5nz+83/OF3npgz56JH2jw6hha3D67h+h66t91zpGdm7dSYhi5X4+iz6x9tsWkTwLnnur+p2y9fdQntX/D1Pf6GZWY++cibb1z2/Nh4DPTr16nTi9sObU755Nges7JafP/sxZEZMzZ//FWnXh8/Ws1a3/jP+ei2dBGxU4N/FRwP1xqQ/Tf/oFtOGb0ZnL3UqlHu45s1M2aFv/tvAPPmZY9qX30VYO5cY27ef1Zq7Hjv69syDvk73QRR9WolZmaOz5qxsrDrHm58qXILihgpf/ddzice30gZKlX6Y/cm02wAVKmydOneA4NM8+DTCF999XD6WYeqVPl9jzHXpDW+tnHTfWlH/P1MDbdGyiJiq5SJO+5oGJ27JNO/PfBFWqdZdXbklCbO+znwANd1P7laH9t727a0tDqVMvYCTJjwe/N6zQbS9JaT2fNoz55L9q+pmdR9/3x4bdcTD1/27O+fp+/YNxvgxg9iEupfUCCYW2vOP7oJ7rnn01o1u+bddKiP57tjI+X+NBnmPwxeL/QiavCRztCwYd4j0tIuv3T2d++837/pC8/Gxd278UDG1nfy7nHkyO/z2w/oEf3x/KPbUjZ3aNvm6IzlJ9KHSsoiEjqHG12V9ZEr1xTG0I8+Dcy8Lpt/rHRW8OFElivRmh187UFW1po1p3Ss0xTgzTe/pkP8wJsBOnSAvTX3zds/H2DD79Cyau2zdnyQc9y2Gxq9kTeQ+fP3B56AsmzZ+huiCtwinrHv2PIwCN5SMpjBtxfetLk/PPn2gzd8s7Jvs/eWJ3f69aKsg3m3x8YOHLBq/z9rTry21s8d2m5Pv6nye94T6UIlZREJpYURw/a8VTt4hfKGNX97RBVSj618/vmpp17S5LuTMv+ErW9WacvNAKtXQ12OBu7UbNYM/qBarmfaeb3Tp+ettO+tcyZk7gdYu7ZNm/wfuWdP3brH1oq6+iK/kTcNPr9vsx2pH3ba/MquLwpsHbkt5b4GLx/9zx0t+i1YOTH2NW7634l0oJ59ISKh9cOxlAy1qhTv4DFjUg7+I+K6V7LXagYeeLVz58LFnejcAaBGjeuvP5y2hMO/5xzTuObgwXAL5wT+jAQ6vFy1Xc72JUdGkPvPEqLq9N6dvW3s2C6PHWR2vZnWTGv55QCLes20Zlr/54o5dVqeyGrWfOed2EZH/Q2r3nfkzwLXNl8YOWTIqxv3bh18duShhLh3+GXe+1NdJ1sn8BQWjZRFJKRcMfBHZrNXyKx+ep/GjRuk+6P/evB3JPfKoUNDBk/+ZtyV/+6RNCcmpl8/v3+dC+DqKxeteNNz5uS96y+6qHXrUTtTqu2bBS6XZXW3ht7qzwRY2OXAYoBqF+Z9weuerJk/bnjq2Lr77pbBN6gcPuwbEzk2o8DDlow5uHJmlAncHWpZ/fq9+WazZhN+ndxxaMbQKivX3HzzJ//zB+8drRr1T/PxgsWnr7kqNvrCk178ZWOXNb2u+jl2/G0FZ7r/lpKyiITURRfUmbP3QbbAoddet6Dhlr0PFr1367Eb8r1Id+53XQeO+bhTq8uabzv4494v666tdHAJ/P5757Ne/27AhZUzlm9/Zuu6JquuSdsKffq4XG3N+F2b6j5BR/p2S60L4PHkrbFWRKfM6kdzrftz34rvP5x+uNDQjMkEqFPnqquGDz/llG27btu5suOmF656ZNq4F4Z+9M6Yp/5v7LvvbtgAkJrxn6iUdlv/b8d7KdZl9//51LoHji6OiPhtmOv8LIOIiK2qdss7Mq6yZEVRz1fe8jsxhVURVaf9i10XnnWo28pOH8Yk5JRWatzx3Z4bE/d6vq3ZPbvkggv+2Hmz6ZNxzcT8F73dbHKOW7u24CVx+9Jypi9yK+yBRImJaWnGrNnx7PZBpteWWmdllzY//7l9640xxlxwbc4lcZVbubJfQ2bVPQ/XrFnZn/T4gVPGUSwaKYtIaKXOz7t+pPOQLVObFpJrDvqbDc399ppjMvasLuSd5Gnbfr06b8mXX649qfYTSy7cb/1wykTv1kBpBy7l2JOrfv75h1qf5Ln6YjBtowv71JSUuSsOn5q37Mcfx32+ZfCSBodXbX5i+4ScKy42f3VPixeu7H9H1zap4+umfPHF/jg8R3NuGje7p8Fdd/Wf6D9lL+tq7PvR7h+IiEh+rU6bVnCc/PwjIajZim4IEJPg/qZq8P0pMV3jPq0SvOai44RW+SZQmt9+6sTCKqt1pue76vnfhe5q90ztvoU+vM2q2b3lvVhQu2/z/+bfWMPb8Mq659VwF7tBoelxEZG/0jJqY+/Kl9/T6cwYF3MPjfn1wIqk6z2VrJYhqFpERE5QBDHEBJ4m16DK00U/V05EREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREyrv/B1VUzVNLG3wvAAAAAElFTkSuQmCC\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"查找节点\">查找节点<a title=\"#查找节点\" href=\"#查找节点\"></a></h2>\n<p>有了上文的描述查找节点的逻辑不难实现, 以 RangeByRank 的核心逻辑为例:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; 寻找排名为 rank 的节点, rank 从1开始</span><br><span class=\"line\">func (skiplist *skiplist) getByRank(rank int64)*Node &#123;</span><br><span class=\"line\">    var i int64 &#x3D; 0</span><br><span class=\"line\">    n :&#x3D; skiplist.header</span><br><span class=\"line\">    &#x2F;&#x2F; 从顶层向下查询</span><br><span class=\"line\">    for level :&#x3D; skiplist.level - 1; level &gt;&#x3D; 0; level-- &#123;</span><br><span class=\"line\">        &#x2F;&#x2F; 从当前层向前搜索</span><br><span class=\"line\">        &#x2F;&#x2F; 若当前层的下一个节点已经超过目标 (i+n.level[level].span &gt; rank)，则结束当前层搜索进入下一层</span><br><span class=\"line\">        for n.level[level].forward !&#x3D; nil &amp;&amp; (i+n.level[level].span) &lt;&#x3D; rank &#123;</span><br><span class=\"line\">            i +&#x3D; n.level[level].span</span><br><span class=\"line\">            n &#x3D; n.level[level].forward</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if i &#x3D;&#x3D; rank &#123;</span><br><span class=\"line\">            return n</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return nil</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>ZRangeByScore</code> 命令需要 <code>getFirstInScoreRange</code> 函数找到分数范围内第一个节点:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">func (skiplist *skiplist) getFirstInScoreRange(min *ScoreBorder, max *ScoreBorder) *Node &#123;</span><br><span class=\"line\">    &#x2F;&#x2F; 判断跳表和范围是否有交集，若无交集提早返回</span><br><span class=\"line\">    if !skiplist.hasInRange(min, max) &#123;</span><br><span class=\"line\">        return nil</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    n :&#x3D; skiplist.header</span><br><span class=\"line\">    &#x2F;&#x2F; 从顶层向下查询</span><br><span class=\"line\">    for level :&#x3D; skiplist.level - 1; level &gt;&#x3D; 0; level-- &#123;</span><br><span class=\"line\">        &#x2F;&#x2F; 若 forward 节点仍未进入范围则继续向前(forward)</span><br><span class=\"line\">        &#x2F;&#x2F; 若 forward 节点已进入范围，当 level &gt; 0 时 forward 节点不能保证是 *第一个* 在 min 范围内的节点， 因此需进入下一层查找</span><br><span class=\"line\">        for n.level[level].forward !&#x3D; nil &amp;&amp; !min.less(n.level[level].forward.Score) &#123;</span><br><span class=\"line\">            n &#x3D; n.level[level].forward</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#x2F;&#x2F; 当从外层循环退出时 level&#x3D;0 (最下层), n.level[0].forward 一定是 min 范围内的第一个节点</span><br><span class=\"line\">    n &#x3D; n.level[0].forward</span><br><span class=\"line\">    if !max.greater(n.Score) &#123;</span><br><span class=\"line\">        return nil</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return n</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"插入节点\">插入节点<a title=\"#插入节点\" href=\"#插入节点\"></a></h2>\n<p>插入节点的操作比较多，我们以注释的方式进行说明:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">func (skiplist *skiplist)insert(member string, score float64)*Node &#123;</span><br><span class=\"line\">    &#x2F;&#x2F; 寻找新节点的先驱节点，它们的 forward 将指向新节点</span><br><span class=\"line\">    &#x2F;&#x2F; 因为每层都有一个 forward 指针, 所以每层都会对应一个先驱节点</span><br><span class=\"line\">    &#x2F;&#x2F; 找到这些先驱节点并保存在 update 数组中</span><br><span class=\"line\">    update :&#x3D; make([]*Node, maxLevel)</span><br><span class=\"line\">    rank :&#x3D; make([]int64, maxLevel) &#x2F;&#x2F; 保存各层先驱节点的排名，用于计算span</span><br><span class=\"line\"></span><br><span class=\"line\">    node :&#x3D; skiplist.header</span><br><span class=\"line\">    for i :&#x3D; skiplist.level - 1; i &gt;&#x3D; 0; i-- &#123; &#x2F;&#x2F; 从上层向下寻找</span><br><span class=\"line\">        &#x2F;&#x2F; 初始化 rank</span><br><span class=\"line\">        if i &#x3D;&#x3D; skiplist.level - 1 &#123;</span><br><span class=\"line\">            rank[i] &#x3D; 0</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            rank[i] &#x3D; rank[i + 1]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if node.level[i] !&#x3D; nil &#123;</span><br><span class=\"line\">            &#x2F;&#x2F; 遍历搜索</span><br><span class=\"line\">            for node.level[i].forward !&#x3D; nil &amp;&amp;</span><br><span class=\"line\">                (node.level[i].forward.Score &lt; score ||</span><br><span class=\"line\">                    (node.level[i].forward.Score &#x3D;&#x3D; score &amp;&amp; node.level[i].forward.Member &lt; member)) &#123; &#x2F;&#x2F; same score, different key</span><br><span class=\"line\">                rank[i] +&#x3D; node.level[i].span</span><br><span class=\"line\">                node &#x3D; node.level[i].forward</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        update[i] &#x3D; node</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    level :&#x3D; randomLevel() &#x2F;&#x2F; 随机决定新节点的层数</span><br><span class=\"line\">    &#x2F;&#x2F; 可能需要创建新的层</span><br><span class=\"line\">    if level &gt; skiplist.level &#123;</span><br><span class=\"line\">        for i :&#x3D; skiplist.level; i &lt; level; i++ &#123;</span><br><span class=\"line\">            rank[i] &#x3D; 0</span><br><span class=\"line\">            update[i] &#x3D; skiplist.header</span><br><span class=\"line\">            update[i].level[i].span &#x3D; skiplist.length</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        skiplist.level &#x3D; level</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; 创建新节点并插入跳表</span><br><span class=\"line\">    node &#x3D; makeNode(level, score, member)</span><br><span class=\"line\">    for i :&#x3D; int16(0); i &lt; level; i++ &#123;</span><br><span class=\"line\">        &#x2F;&#x2F; 新节点的 forward 指向先驱节点的 forward</span><br><span class=\"line\">        node.level[i].forward &#x3D; update[i].level[i].forward</span><br><span class=\"line\">        &#x2F;&#x2F; 先驱节点的 forward 指向新节点</span><br><span class=\"line\">        update[i].level[i].forward &#x3D; node</span><br><span class=\"line\"></span><br><span class=\"line\">        &#x2F;&#x2F; 计算先驱节点和新节点的 span</span><br><span class=\"line\">        node.level[i].span &#x3D; update[i].level[i].span - (rank[0] - rank[i])</span><br><span class=\"line\">        update[i].level[i].span &#x3D; (rank[0] - rank[i]) + 1</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; 新节点可能不会包含所有层</span><br><span class=\"line\">    &#x2F;&#x2F; 对于没有层，先驱节点的 span 会加1 (后面插入了新节点导致span+1)</span><br><span class=\"line\">    for i :&#x3D; level; i &lt; skiplist.level; i++ &#123;</span><br><span class=\"line\">        update[i].level[i].span++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; 更新后向指针</span><br><span class=\"line\">    if update[0] &#x3D;&#x3D; skiplist.header &#123;</span><br><span class=\"line\">        node.backward &#x3D; nil</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">        node.backward &#x3D; update[0]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if node.level[0].forward !&#x3D; nil &#123;</span><br><span class=\"line\">        node.level[0].forward.backward &#x3D; node</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">        skiplist.tail &#x3D; node</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    skiplist.length++</span><br><span class=\"line\">    return node</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>randomLevel 用于随机决定新节点包含的层数，随机结果出现 2 的概率是出现 1 的 25%， 出现 3 的概率是出现 2 的 25%:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">func randomLevel() int16 &#123;</span><br><span class=\"line\">    level :&#x3D; int16(1)</span><br><span class=\"line\">    for float32(rand.Int31()&amp;0xFFFF) &lt; (0.25 * 0xFFFF) &#123;</span><br><span class=\"line\">        level++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if level &lt; maxLevel &#123;</span><br><span class=\"line\">        return level</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return maxLevel</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"删除节点\">删除节点<a title=\"#删除节点\" href=\"#删除节点\"></a></h2>\n<p>删除节点的思路与插入节点基本一致:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; 删除操作可能一次删除多个节点</span><br><span class=\"line\">func (skiplist *skiplist) RemoveRangeByRank(start int64, stop int64)(removed []*Element) &#123;</span><br><span class=\"line\">    var i int64 &#x3D; 0  &#x2F;&#x2F; 当前指针的排名</span><br><span class=\"line\">    update :&#x3D; make([]*Node, maxLevel)</span><br><span class=\"line\">    removed &#x3D; make([]*Element, 0)</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; 从顶层向下寻找目标的先驱节点</span><br><span class=\"line\">    node :&#x3D; skiplist.header</span><br><span class=\"line\">    for level :&#x3D; skiplist.level - 1; level &gt;&#x3D; 0; level-- &#123;</span><br><span class=\"line\">        for node.level[level].forward !&#x3D; nil &amp;&amp; (i+node.level[level].span) &lt; start &#123;</span><br><span class=\"line\">            i +&#x3D; node.level[level].span</span><br><span class=\"line\">            node &#x3D; node.level[level].forward</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        update[level] &#x3D; node</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    i++</span><br><span class=\"line\">    node &#x3D; node.level[0].forward &#x2F;&#x2F; node 是目标范围内第一个节点</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F; 删除范围内的所有节点</span><br><span class=\"line\">    for node !&#x3D; nil &amp;&amp; i &lt; stop &#123;</span><br><span class=\"line\">        next :&#x3D; node.level[0].forward</span><br><span class=\"line\">        removedElement :&#x3D; node.Element</span><br><span class=\"line\">        removed &#x3D; append(removed, &amp;removedElement)</span><br><span class=\"line\">        skiplist.removeNode(node, update)</span><br><span class=\"line\">        node &#x3D; next</span><br><span class=\"line\">        i++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return removed</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>接下来分析一下执行具体节点删除操作的 removeNode 函数:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; 传入目标节点和删除后的先驱节点</span><br><span class=\"line\">&#x2F;&#x2F; 在批量删除时我们传入的 update 数组是相同的</span><br><span class=\"line\">func (skiplist *skiplist) removeNode(node *Node, update []*Node) &#123;</span><br><span class=\"line\">    for i :&#x3D; int16(0); i &lt; skiplist.level; i++ &#123;</span><br><span class=\"line\">        &#x2F;&#x2F; 如果先驱节点的forward指针指向了目标节点，则需要修改先驱的forward指针跳过要删除的目标节点</span><br><span class=\"line\">        &#x2F;&#x2F; 同时更新先驱的 span</span><br><span class=\"line\">        if update[i].level[i].forward &#x3D;&#x3D; node &#123;</span><br><span class=\"line\">            update[i].level[i].span +&#x3D; node.level[i].span - 1</span><br><span class=\"line\">            update[i].level[i].forward &#x3D; node.level[i].forward</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            update[i].level[i].span--</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#x2F;&#x2F; 修改目标节点后继节点的backward指针</span><br><span class=\"line\">    if node.level[0].forward !&#x3D; nil &#123;</span><br><span class=\"line\">        node.level[0].forward.backward &#x3D; node.backward</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">        skiplist.tail &#x3D; node.backward</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#x2F;&#x2F; 必要时删除空白的层</span><br><span class=\"line\">    for skiplist.level &gt; 1 &amp;&amp; skiplist.header.level[skiplist.level-1].forward &#x3D;&#x3D; nil &#123;</span><br><span class=\"line\">        skiplist.level--</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    skiplist.length--</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>作者：finley</p>\n<p>出处：<a href=\"https://www.cnblogs.com/Finley/p/12854599.html\" target=\"_blank\">https://www.cnblogs.com/Finley/p/12854599.html</a></p>\n<p>版权：本作品采用「署名 - 非商业性使用 - 相同方式共享 4.0 国际」许可协议进行许可。</p>\n</blockquote>\n<p><strong>推荐阅读</strong></p>\n<p><strong><a href=\"http://mp.weixin.qq.com/s?__biz=MzAxMTA4Njc0OQ==&amp;mid=2651444034&amp;idx=2&amp;sn=02801f421c98afc557593205425d4834&amp;chksm=80bb0db0b7cc84a6b892179a3cef264867e16b1d78e7896291c8c1c228ff82fb198da60177cb&amp;scene=21#wechat_redirect\" target=\"_blank\">Go 项目实战：实现一个 Redis(4) 之 AOF 持久化与 AOF 重写</a></strong></p>\n","prev":{"title":"【转载】Go 项目实战：实现一个 Redis(6) 之实现 pipeline 模式的 redis 客户端","link":"2021/03/14/2021-03-13-07"},"next":{"title":"【转载】Go 项目实战：实现一个 Redis(4) 之 AOF 持久化与 AOF 重写","link":"2021/03/14/2021-03-13-05"},"plink":"https://terence.segofun.com/2021/03/14/2021-03-13-06/","toc":[{"id":"结构定义","title":"结构定义","index":"1"},{"id":"查找节点","title":"查找节点","index":"2"},{"id":"插入节点","title":"插入节点","index":"3"},{"id":"删除节点","title":"删除节点","index":"4"}],"reading_time":"3222 words in 21 min"}